<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />
        <title>ELGIO || Ecommerce</title>
        <link rel="stylesheet" href="style.css">
        <script src="js/cart.js"></script>
    </head>

    <body>

        <section id="header">
            <a href="#"><img src="img/logo.png" class="logo"></a>

            <div>
                <ul id="navbar">
                    <li><a href="index.html" class="active">Home</a></li>
                    <li><a href="shop.html">Shop</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li id="lg-bag"><a href="cart.html"><i class="far fa-shopping-bag"></i></a></li>
                    <a href="#" id="close"><i class="fa fa-times"></i></a>
                </ul>
            </div>
            <div id="mobile">
                <a href="cart.html"><i class="far fa-shopping-bag"></i></a>
                <i id="bar" class="fas fa-outdent"></i>
            </div>
        </section>

        <section id="prodetails" class="section-p1">
            <div class="single-pro-image">
                <img src="img/products/f1.jpg" width="100%" id="MainImg">

                <div class="small-img-group">
                    <div class="small-img-col">
                        <img src="img/products/f1.jpg" width="100%" class="small-img ">
                    </div>
                    <div class="small-img-col">
                        <img src="img/products/f2.jpg" width="100%" class="small-img ">
                    </div>
                    <div class="small-img-col">
                        <img src="img/products/f3.jpg" width="100%" class="small-img ">
                    </div>
                    <div class="small-img-col">
                        <img src="img/products/f4.jpg" width="100%" class="small-img ">
                    </div>
                </div>
            </div>

            <div class="single-pro-details" data-id="produk1">
                <h6>Home / T-Shirt</h6>
                <h4>Men's Fashion T Shirt</h4>
                <h2>$139.00</h2>
                <select class="size-select">
                    <option value="">Select Size</option>
                    <option value="S">S</option>
                    <option value="M">M</option>
                    <option value="L">L</option>
                    <option value="XL">XL</option>
                </select>
                <input type="number" value="1" min="1">
                <button class="normal add-to-cart"><i class="far fa-shopping-cart cart"></i>‎ ‎ ‎ ‎ Add To Cart</button>
                <h4>Product Details</h4>
                <span >The Gildan Ultra Cotton T-shirt 1s made from a substantial 6.0 oz. per 
                    sq. yd. fabric constructed from 160% cotton, this classic fit preshrunk 
                    jersey knit provides unmatched comfort with each wear. Featuring a taped neck 
                    and shoulder, and a seamless double-needle collar, and available in a range 
                    of colors, it offers it all in the ultimate head-turning package.</span>
            </div>
        </section>

        <section id="product1" class="section-p1">
            <h2>Featured Product</h2>
            <p>Summer Collection New Morden Design </p>
            <div class="pro-container">
                <div class="pro" data-id="product1">
                    <img src="img/products/n1.jpg">
                    <div class="des">
                        <span>adidas</span>
                        <h5>Cartoon Astronaut T-Shirts</h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4>$78</h4>
                    </div>
                    <a href="#"><i class="fal fa-shopping-cart cart"></i></a>
                </div>
                <div class="pro">
                    <img src="img/products/n2.jpg">
                    <div class="des">
                        <span>adidas</span>
                        <h5>Cartoon Astronaut T-Shirts</h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4>$78</h4>
                    </div>
                    <a href="#"><i class="fal fa-shopping-cart cart"></i></a>
                </div>
                <div class="pro">
                    <img src="img/products/n3.jpg">
                    <div class="des">
                        <span>adidas</span>
                        <h5>Cartoon Astronaut T-Shirts</h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4>$78</h4>
                    </div>
                    <a href="#"><i class="fal fa-shopping-cart cart"></i></a>
                </div>
                <div class="pro">
                    <img src="img/products/n4.jpg">
                    <div class="des">
                        <span>adidas</span>
                        <h5>Cartoon Astronaut T-Shirts</h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4>$78</h4>
                    </div>
                    <a href="#"><i class="fal fa-shopping-cart cart"></i></a>
                </div> 
            </div>
        </section>

        <section id="newsletter" class="section-p1" class="section-m1">
            <div class="newstext">
                <h4>Sign Up For Newletters</h4>
                <p>Get E-mail updates about our latest shop and <span>special offers</span></p>
            </div>
            <div class="form">
                <button class="normal" onclick="window.location.href='registration.html'">Sign Up</button>
                <button class="normal" onclick="window.location.href='login.html'">Sign in</button>
            </div>
        </section>

        <footer class="section-p1">
            <div class="col">
                <img src="img/logo.png">
                <h4>Contact</h4>
                <p><strong>Address:</strong> 562 Wellington Road, Street 32, Fransisco</p>
                <p><strong>Phone:</strong> +01 2222 365 /(+91) 01 2345 6789</p>
                <p><strong>Hours:</strong> 10:00 - 18:00, Mon - Sat</p>
                <div class="follow">
                    <h4>Follow us</h4>
                    <div class="icon">
                        <i class="fab fa-facebook-f"></i>
                        <i class="fab fa-twitter"></i>
                        <i class="fab fa-instagram"></i>
                        <i class="fab fa-pinterest-p"></i>
                        <i class="fab fa-youtube"></i>
                    </div>
                </div>
            </div>

            <div class="col">
                <h4>About</h4>
                <a href="#">About us</a>
                <a href="#">Delivery Information</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Terms & Conditions</a>
                <a href="#">Contact us</a>
            </div>

            <div class="col">
                <h4>My Account</h4>
                <a href="#">Sign In</a>
                <a href="#">View Cart</a>
                <a href="#">My Wishlist</a>
                <a href="#">Track My Order</a>
                <a href="#">Help</a>
            </div>

            <div class="col install">
                <h4>Install App</h4>
                <p>From App Store or Google Play</p>
                <div class="row">
                    <img src="img/pay/app.jpg">
                    <img src="img/pay/play.jpg">
                </div>
                <p>Secured Payment Gateways</p>
                <img src="img/pay/pay.png">
            </div>
            
            <div class="copright">
                <p>© 2024, Tech2 etc - HTML CSS Ecommerce Template</p>
            </div>
        </footer>

        <script>
            var Mainimg = document.getElementById("MainImg");
            var smalling = document.getElementsByClassName("small-img");

            smalling[0].onclick = function(){
                MainImg.src = smalling[0].src;
            }
            smalling[1].onclick = function(){
                MainImg.src = smalling[1].src;
            }
            smalling[2].onclick = function(){
                MainImg.src = smalling[2].src;
            }
            smalling[3].onclick = function(){
                MainImg.src = smalling[3].src;
            }

            
        </script>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
    setupAddToCartListeners();
    updateCartBadge();
    setupImageSwitching(); // Fungsi baru untuk perpindahan gambar

    // Panggil displayCartItems jika sedang di halaman cart
    if (window.location.pathname.includes('cart.html')) {
        displayCartItems();
    }
});

function setupImageSwitching() {
    var MainImg = document.getElementById("MainImg");
    var smalling = document.getElementsByClassName("small-img");

    for (let i = 0; i < smalling.length; i++) {
        smalling[i].onclick = function() {
            MainImg.src = smalling[i].src;
        }
    }
}

function setupAddToCartListeners() {
    const addToCartButtons = document.querySelectorAll('.add-to-cart');
    
    addToCartButtons.forEach(button => {
        button.removeEventListener('click', addToCartHandler);
        button.addEventListener('click', addToCartHandler);
    });
}

function addToCartHandler(event) {
    event.preventDefault();
    event.stopPropagation();

    const productCard = this.closest('.single-pro-details');
    if (!productCard) {
        console.error('Produk tidak ditemukan');
        return;
    }

    const sizeSelect = productCard.querySelector('.size-select');
    const selectedSize = sizeSelect.value;

    if (!selectedSize) {
        alert('Silakan pilih ukuran terlebih dahulu!');
        return;
    }

    const productData = {
        id: productCard.getAttribute('data-id'),
        name: productCard.querySelector('h4').textContent,
        price: parseFloat(productCard.querySelector('h2').textContent.replace('$', '')),
        size: selectedSize,
        quantity: 1, 
        image: productCard.closest('.section-p1').querySelector('#MainImg').src
    };

    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    const existingProductIndex = cart.findIndex(
        item => item.id === productData.id && item.size === productData.size
    );

    if (existingProductIndex > -1) {
        cart[existingProductIndex].quantity += 1;
    } else {
        cart.push(productData);
    }

    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartBadge();
    alert(`${productData.name} dengan ukuran ${productData.size} telah ditambahkan ke keranjang!`);
}

function updateCartBadge() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
    
    const shoppingBagIcon = document.querySelector('#lg-bag a');
    
    if (shoppingBagIcon) {
        const existingBadge = shoppingBagIcon.querySelector('.cart-badge');
        if (existingBadge) {
            existingBadge.remove();
        }
        
        if (cartCount > 0) {
            const badge = document.createElement('span');
            badge.classList.add('cart-badge');
            badge.textContent = cartCount;
            
            badge.style.position = 'absolute';
            badge.style.top = '-8px';
            badge.style.right = '-8px';
            badge.style.backgroundColor = 'red';
            badge.style.color = 'white';
            badge.style.borderRadius = '50%';
            badge.style.padding = '2px 6px';
            badge.style.fontSize = '10px';
            
            shoppingBagIcon.style.position = 'relative';
            shoppingBagIcon.appendChild(badge);
        }
    }
}

function displayCartItems() {
    const cartItemsContainer = document.getElementById('cart-items');
    
    if (!cartItemsContainer) {
        console.error('Kontainer cart-items tidak ditemukan');
        return;
    }

    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    cartItemsContainer.innerHTML = '';

    if (cart.length === 0) {
        cartItemsContainer.innerHTML = '<tr><td colspan="5">Keranjang Anda kosong</td></tr>';
        return;
    }

    cart.forEach((item, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>
                <a href="#" onclick="removeItem(${index})">
                    <i class="far fa-times-circle"></i>
                </a>
            </td>
            <td>
                <img src="${item.image}" alt="${item.name}" style="width: 70px; height: 70px; object-fit: cover;">
            </td>
            <td>${item.name}</td>
            <td>$${item.price.toFixed(2)}</td>
            <td>
                <input type="number" value="${item.quantity}" 
                       min="1" 
                       onchange="updateQuantity(${index}, this.value)">
            </td>
            <td>$${(item.price * item.quantity).toFixed(2)}</td>
        `;
        cartItemsContainer.appendChild(row);
    });

    updateCartTotal();
}

function updateQuantity(index, newQuantity) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    newQuantity = Math.max(1, parseInt(newQuantity));
    
    cart[index].quantity = newQuantity;
    
    localStorage.setItem('cart', JSON.stringify(cart));
    
    displayCartItems();
    updateCartBadge();
}

function removeItem(index) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    cart.splice(index, 1);
    
    localStorage.setItem('cart', JSON.stringify(cart));
    
    displayCartItems();
    updateCartBadge();
}

function updateCartTotal() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const tax = subtotal * 0.1;
    const total = subtotal + tax;

    const subtotalElement = document.getElementById('cart-subtotal');
    const taxElement = document.getElementById('cart-tax');
    const totalElement = document.getElementById('cart-total');

    if (subtotalElement) subtotalElement.textContent = `$${subtotal.toFixed(2)}`;
    if (taxElement) taxElement.textContent = `$${tax.toFixed(2)}`;
    if (totalElement) totalElement.textContent = `$${total.toFixed(2)}`;
}

function clearCart() {
    localStorage.removeItem('cart');
    
    displayCartItems();
    updateCartBadge();
}

document.addEventListener('DOMContentLoaded', function() {
    const checkoutButton = document.getElementById('checkout-btn');
    
    if (checkoutButton) {
        checkoutButton.addEventListener('click', function() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            
            if (cart.length === 0) {
                alert('Keranjang Anda kosong!');
                return;
            }
            
            alert('Terima kasih telah berbelanja!');
            clearCart();
        });
    }
});
        </script>

        <script src="script.js"></script>
    </body>

</html>